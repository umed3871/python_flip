{% extends "base.html" %} {% load cart %}

<!--title block-->
{% block title %} Flipkart {% endblock title %}

<!--body tag-->

{% block body %}
<!--This is for category-->
<div class="container my-2 bg-secondary">
  <div class="row text-center">
    {% for cat in category %}
    <div class="col">
      <a href="?category_id={{cat.id}}">
        <img
          src="{{cat.category_image.url}}"
          alt="no image"
          width="50"
          height="50"
        />
        <br />
        <h5>{{cat.category_name}}</h5>
      </a>
    </div>

    {% endfor %}
  </div>
</div>

<!--This is for product-->

<div class="container">
  <div class="row text-center">
    {% for pro in product %}
    <div class="col">
      <div class="card" style="width: 18rem">
        <img
          src="{{pro.product_image.url}}"
          class="card-img-top"
          alt="..."
          width="100"
          height="150"
        />
        <br />
        <div class="card-body">
          <h5 class="card-title">{{pro.product_name}}</h5>
          <p class="card-text">Rs.{{pro.product_price}}</p>
          <p class="card-text">{{pro.product_desc}}</p>
        </div>
        <div class="card-footer text-body-secondary">
          {% if pro|isexistsincart:request.session.cart %}
          <div class="row">
            <div class="col-2">
              <form action="" method="post">
                {% csrf_token %}
                <input type="text" name="productid" value="{{pro.id}}" hidden />
                <input type="text" name="remove" value="{{pro.id}}" hidden />
                <input type="submit" value="-" class="btn btn-primary" />
              </form>
            </div>
            <div class="col-8">{{pro|cart_quantity:request.session.cart}}</div>
            <div class="col-2">
              <form action="" method="post">
                {% csrf_token %}
                <input type="text" name="productid" value="{{pro.id}}" hidden />
                <input type="submit" value="+" class="btn btn-primary" />
              </form>
            </div>
          </div>

          {% else %}

          <form action="" method="post">
            {% csrf_token %}
            <input type="text" name="productid" value="{{pro.id}}" hidden />
            <input type="submit" value="Add to Cart" class="btn btn-primary" />
          </form>
          {% endif %}
        </div>
      </div>
    </div>

    {% endfor %}
  </div>
</div>

{% endblock body %}
